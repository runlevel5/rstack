--- a/src/x86/Ginit.c
+++ b/src/x86/Ginit.c
@@ -130,6 +130,14 @@ access_reg (unw_addr_space_t as, unw_regnum_t reg, unw_word_t *val, int write,
   unw_word_t *addr;
   ucontext_t *uc = ((struct cursor *)arg)->uc;
 
+  if (!uc)
+    {
+      /* uc is NULL during DWARF-based unwinding with DWARF_LOC_TYPE_REG.
+         Return an error since we can't access registers without a ucontext.
+         See: https://github.com/libunwind/libunwind/issues/938 */
+      return -UNW_EBADREG;
+    }
+
   if (unw_is_fpreg (reg))
     goto badreg;
 
@@ -156,6 +164,11 @@ access_fpreg (unw_addr_space_t as, unw_regnum_t reg, unw_fpreg_t *val,
   ucontext_t *uc = ((struct cursor *)arg)->uc;
   unw_fpreg_t *addr;
 
+  if (!uc)
+    {
+      return -UNW_EBADREG;
+    }
+
   if (!unw_is_fpreg (reg))
     goto badreg;
 
